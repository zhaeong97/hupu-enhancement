# 虎扑增强脚本 (Hupu Enhancement)

一个功能强大的 Tampermonkey 用户脚本，为虎扑论坛提供图片优化、视频悬浮、评论交互增强等多项功能，大幅提升浏览体验。

## 📋 功能特性

### 🖼️ 图片增强功能
- **智能缩放**：鼠标悬停自动放大图片
- **滚轮缩放**：按住 `Z` 键 + 滚轮自由调节图片大小
- **一键最大化**：按 `A` 键将图片最大化显示
- **平滑过渡**：所有缩放操作都有平滑动画效果

### 🎬 视频增强功能
- **视频悬浮播放**：滚动页面时视频悬浮在角落继续播放
- **视频缩放控制**：按住 `Z` 键 + 滚轮调节视频尺寸
- **横竖屏自适应**：自动识别横屏/竖屏视频并优化显示
- **拖拽调整**：悬浮窗口可随意拖拽到屏幕任意位置
- **尺寸调节**：右下角手柄可调整悬浮窗大小

### 💬 评论交互优化
- **一键收起评论**：点击页面空白处收起所有展开的评论
- **智能定位**：收起评论时自动跳转到最后查看位置
- **楼主标记**：二级评论中清晰标记楼主身份
- **评论追踪**：记住最后点击的评论位置

### 🔧 工具栏优化
- **右侧悬浮工具栏**：推荐、收藏、分享等工具悬浮在右侧
- **边看边操作**：浏览长贴时不用返回顶部即可操作
- **楼主直达**：点击楼主头像快速访问楼主主页
- **状态同步**：悬浮工具栏与原工具栏状态实时同步

### ⚙️ 丰富的自定义设置
- **可视化设置面板**：通过 `⚙️ 设置中心` 菜单打开
- **图片缩放设置**：调整默认宽度、悬浮宽度、缩放比例等
- **视频悬浮设置**：配置悬浮窗大小、位置、开关状态
- **评论交互设置**：自定义收起评论行为
- **快捷键设置**：自定义缩放和最大化快捷键

## 🚀 安装方法

### 前提条件
1. 安装用户脚本管理器：
    - [Tampermonkey](https://www.tampermonkey.net/) (Chrome/Edge/Firefox/Safari)
    - [Violentmonkey](https://violentmonkey.github.io/)
    - [Greasemonkey](https://www.greasespot.net/) (仅Firefox)

2. 确保脚本管理器已启用

### 安装脚本
1. 点击下方链接安装：
   [安装虎扑增强脚本](https://raw.githubusercontent.com/你的仓库地址/虎扑增强-0.38.user.js)

2. 脚本管理器会自动检测并弹出安装确认框
3. 点击"安装"按钮即可

## 🎯 使用方法

### 基本操作
1. **打开设置**：点击Tampermonkey图标 → 点击"虎扑增强" → 选择"⚙️ 设置中心"
2. **查看帮助**：点击Tampermonkey图标 → 点击"虎扑增强" → 选择"📚 帮助中心"
3. **图片缩放**：
    - 鼠标悬停：自动放大
    - 按住 `Z` + 滚轮：自由缩放
    - 按 `A` 键：最大化显示
4. **视频悬浮**：播放视频后滚动页面，视频会自动悬浮

### 快捷键说明
| 快捷键 | 功能 | 说明             |
|--------|------|----------------|
| `Z` 键 | 缩放控制 | 按住 + 滚轮缩放图片/视频 |
| `A` 键 | 最大化 | 按一下将图片/视频最大化   |
| `空格` | 播放/暂停 | 鼠标悬停视频后按空格播放   |
| - | - | 相关快捷键可在设置中自定义  |

### 配置说明
脚本提供完整的配置系统，所有设置自动保存：
- **图片设置**：默认宽度、悬浮宽度、缩放比例
- **视频设置**：横竖屏默认尺寸、悬浮窗尺寸
- **交互设置**：评论收起行为、滚动定位
- **快捷键**：可自定义控制键

## 🔧 技术特点

### 架构设计
- **模块化设计**：图片缩放、视频悬浮、评论处理等功能独立模块
- **配置管理**：统一的配置管理系统，支持增量更新和持久化存储
- **工具封装**：通用工具函数封装，提高代码复用性

### 性能优化
- **节流防抖**：滚动和调整大小事件使用节流优化
- **事件代理**：使用事件委托减少事件监听器数量
- **动画优化**：使用 CSS 过渡和 `requestAnimationFrame`

### 兼容性
- **浏览器兼容**：支持 Chrome、Edge、Firefox、Safari 等现代浏览器
- **响应式设计**：适配不同屏幕尺寸
- **移动端考虑**：支持触摸事件（触摸拖动）

## 🛠️ 开发相关

### 项目结构
```
虎扑增强脚本/
├── ==UserScript==       # 脚本元信息
├── ConfigManager        # 配置管理类
├── Utils               # 工具函数库
├── ImageZoom           # 图片缩放模块
├── VideoFloat          # 视频悬浮模块
├── ReplyHandler        # 评论处理模块
├── ToolsFloat          # 工具栏悬浮模块
├── Settings            # 设置中心模块
└── 初始化函数          # 脚本初始化逻辑
```

### 核心模块
1. **ConfigManager**：配置的读取、保存、重置
2. **Utils**：滚动控制、视口检测、样式管理等工具函数
3. **ImageZoom**：图片缩放、快捷键处理、鼠标事件
4. **VideoFloat**：视频悬浮、拖拽、大小调整
5. **ReplyHandler**：评论展开收起、定位高亮
6. **ToolsFloat**：工具栏克隆、事件代理、状态同步
7. **Settings**：设置面板生成、表单验证、配置保存

### 扩展性
- **插件化设计**：新功能可以独立模块形式添加
- **配置驱动**：行为通过配置文件控制，无需修改代码

## 📝 更新日志

### v1.4.0 (当前版本)
- ✅ 完整的图片缩放和视频悬浮功能
- ✅ 评论交互增强和工具栏优化
- ✅ 可视化设置中心和详细帮助文档
- ✅ 多语言支持和自动更新机制
- ✅ 全面的键盘快捷键支持

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

### 问题反馈
1. 确保使用最新版本脚本
2. 描述具体问题和复现步骤
3. 提供浏览器版本和脚本管理器信息

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## ⚠️ 免责声明

本脚本为第三方开发工具，与虎扑官方无关。使用本脚本请遵守：
1. 虎扑社区的用户协议
2. 不要用于恶意刷帖、广告等违规行为
3. 尊重其他用户的浏览体验

## 🌟 致谢

感谢以下开源项目：
- [jQuery](https://jquery.com/) - JavaScript 库
- [layui](https://layui.dev/) - 前端 UI 框架
- [Tampermonkey](https://www.tampermonkey.net/) - 用户脚本管理器

---

**Made with ❤️ for the Hupu community**

*如有任何问题或建议，请通过 GitHub Issues 反馈*
